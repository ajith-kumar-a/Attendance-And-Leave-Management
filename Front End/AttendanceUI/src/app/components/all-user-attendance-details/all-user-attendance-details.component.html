<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="shortcut icon" type="image/x-icon" href="https://production-assets.codepen.io/assets/favicon/favicon-8ea04875e70c4b0bb41da869e81236e54394d63638a1ef12fa558a4a835f1164.ico" />
  <link rel="mask-icon" type="" href="https://production-assets.codepen.io/assets/favicon/logo-pin-f2d2b6d2c61838f7e76325261b7195c27224080bc099486ddd6dccb469b8e8e6.svg" color="#111" />
  <title>Attendance Details by Role</title>
  <link rel="stylesheet" href="all-user-attendance-details.component.css"> <!-- Link to your CSS file -->
</head>
<body>
  <div class="container">
    <h2 class="heading">Attendance Details by Role</h2>

    <div class="role-section" *ngFor="let roleId of roleIds">
      <h3 class="role-id">Role ID: {{ roleId }}</h3>

      <table class="attendance-table" *ngIf="attendanceData[roleId]?.length">
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Status</th> <!-- Updated column header -->
            <th>Remarks</th>
            <th>Date</th>
            <th>Login Time</th>
            <th>Logout Time</th>
            <th>Action</th> <!-- Add action column -->
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let record of attendanceData[roleId]">
            <td>{{ record.id }}</td>
            <td>{{ getUsername(record.user_id) }}</td> <!-- Display username -->
            <td>{{ getStatusName(record.status_id) }}</td> <!-- Display status name -->
            <td>{{ record.remarks }}</td>
            <td>{{ record.date }}</td>
            <td>{{ record.login_time }}</td>
            <td>{{ record.logout_time || 'N/A' }}</td>
            <td>
              <!-- Dropdown to select new status -->
              <select (change)="onStatusChange($event, record.id)">
                <option *ngFor="let status of statusMap | keyvalue" [value]="status.key">
                  {{ status.value }}
                </option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>

      <p class="no-records" *ngIf="!(attendanceData[roleId]?.length)">No attendance records found for this role.</p>
    </div>
  </div>
</body>
</html>